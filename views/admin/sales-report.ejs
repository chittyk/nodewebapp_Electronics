<%- include("../../views/partials/admin/header") %>




    <style>
        body {
            background-color: #f4f6f9;
        }

        .dashboard-card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .report-btn {
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .stats-card {
            text-align: center;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
        }

        .stats-card h3 {
            color: #007bff;
            margin-bottom: 10px;
        }

        .stats-card .value {
            font-size: 24px;
            font-weight: bold;
        }

        .table-hover tbody tr:hover {
            background-color: #f5f5f5;
        }
    </style>
    </head>

    <body>
        <div class="container-fluid p-4" style="margin-left: 250px; width: 1356px;">
            <h1 class="mb-4">Sales Report Dashboard</h1>

            <!-- Report Type Selection -->
            <div class="card dashboard-card">
                <div class="card-body">
                    <div class="report-type-buttons mb-3">
                        <button id="dailyBtn" class="btn report-btn btn-primary">Daily</button>
                        <button id="weeklyBtn" class="btn report-btn btn-outline-primary">Weekly</button>
                        <button id="monthlyBtn" class="btn report-btn btn-outline-primary">Monthly</button>
                        <button id="customBtn" class="btn report-btn btn-outline-primary">Custom</button>

                    </div>

                    <!-- Date Range Selection -->
                    <div id="customDateRange" class="row" style="display:none;">
                        <div class="col-md-4">
                            <label class="form-label">Start Date</label>
                            <input type="date" id="startDate" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">End Date</label>
                            <input type="date" id="endDate" class="form-control">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">&nbsp;</label>
                            <button id="generateReport" class="btn btn-success form-control">Generate Report</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Summary Statistics -->
            <div class="row">
                <div class="col-md-4">
                    <div class="stats-card">
                        <h3>Total Sales</h3>
                        <div id="totalSales" class="value">$0</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stats-card">
                        <h3>Total Discounts</h3>
                        <div id="totalDiscounts" class="value">$0</div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stats-card">
                        <h3>Total Orders</h3>
                        <div id="totalOrders" class="value">0</div>
                    </div>
                </div>
            </div>

            <!-- Sales Report Table -->
            <div class="card dashboard-card mt-4">
                <div class="card-body">
                    <h5 class="card-title">Detailed Sales Report</h5>
                    <div class="table-responsive">
                        <table id="salesReportTable" class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>Date</th>
                                    <th>Total Revenue</th>

                                    <th>Total Sales</th>
                                    <th>Discounts</th>
                                    <th>Coupon deduction </th>
                                    <th>Orders</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody >
                                <% if (orders) { %>
                                    <th>Date</th>
                                    <th>Total Revenue</th>

                                    <th>Total Sales</th>
                                    <th>Discounts</th>
                                    <th>Coupon deduction </th>
                                    <th>Orders</th>
                                    <th></th>
                                <% } %>
                            </tbody>
                        </table>
                        <div class="d-flex justify-content-center">
                            <ul class="pagination">
                                <% if (currentPage > 1) { %>
                                    <li class="page-item">
                                        <a class="page-link" href="?page=<%= currentPage - 1 %>&limit=<%= limit %>">Previous</a>
                                    </li>
                                <% } else { %>
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#">Previous</a>
                                    </li>
                                <% } %>
                        
                                <!-- Loop through the page numbers -->
                                <% for (let i = 1; i <= totalPages; i++) { %>
                                    <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                        <a class="page-link" href="?page=<%= i %>&limit=<%= limit %>"><%= i %></a>
                                    </li>
                                <% } %>
                        
                                <% if (currentPage < totalPages) { %>
                                    <li class="page-item">
                                        <a class="page-link" href="?page=<%= currentPage + 1 %>&limit=<%= limit %>">Next</a>
                                    </li>
                                <% } else { %>
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#">Next</a>
                                    </li>
                                <% } %>
                            </ul>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>

        <!-- Bootstrap JS and Dependencies -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


        <script>
            // Wait for the DOM to fully load
            document.addEventListener('DOMContentLoaded', function () {
                const reportButtons = ['dailyBtn', 'weeklyBtn', 'monthlyBtn', 'customBtn'];
                const customDateRange = document.getElementById('customDateRange');
                let endpoint = ""
                reportButtons.forEach(function (btnId) {
                    const button = document.getElementById(btnId);
                    button.addEventListener('click', function () {
                        // Reset all button styles
                        reportButtons.forEach(function (id) {
                            const btn = document.getElementById(id);
                            btn.classList.remove('btn-primary');
                            btn.classList.add('btn-outline-primary');
                        });

                        // Highlight the clicked button
                        button.classList.remove('btn-outline-primary');
                        button.classList.add('btn-primary');

                        // Show custom date range only for 'customBtn'
                        if (btnId === 'customBtn') {
                            customDateRange.style.display = 'flex';
                            endpoint = 'c'
                        } else if (btnId === 'dailyBtn') {
                            customDateRange.style.display = 'none';
                            endpoint = 'd'
                        } else if (btnId === 'weeklyBtn') {
                            customDateRange.style.display = 'none';
                            endpoint = 'w'
                        } else if (btnId === 'monthlyBtn') {
                            customDateRange.style.display = 'none';
                            endpoint = 'm'
                        } else {
                            Swal.fire({
                                icon: "error",
                                title: "Oops...",
                                text: "Something went wrong!",
                                
                            });
                        }
                        try {
                            if(endpoint !== 'c'){
                            window.location.href = `/admin/salesReport/?basedOn=${endpoint}`;
                            }
                        } catch (error) {
                            
                        }

                    });
                });
            });

        </script>


        <script>


        </script>



        <%- include("../../views/partials/admin/footer") %>